# BAHD_manuscript

 Scripts used in the BAHD manuscript

## Requirements
-- Python 3.6+

-- Unix

-- BLAST

Download all files in **RequiredFiles** folder as well as all provided scripts to your own working directory

## Usage

Step 1: Perform a BLAST between FASTA sequences of your favorite BAHDs and the file labeled all_BAHDs.fa

Note you will need to format the database file beforehand
```bash   
   formatdb -i all_BAHDs.fa -p T
   blastall -i sl_bahd.fa -d all_BAHDs.fa -m 8 -e 1e-10 -a 20 -o qSL24_dALL.blp -p blastp
 ```     
Step 2: Get the top BLAST hits for each query
```bash   
   python blast_gettop.py qSL24_dALL.blp
 ```     
Step 3: Assign hits to orthogroups based on BLAST results. Orthogroups.txt and species.list files are provided in this repository
```bash
   python assign_to_orthogroups.py Orthogroups.txt species.list qSL24_dALL.blp.top   
 ```     
 Step 4: Map substrate classes. The second *.range* file will be generated by above script. All other files are provided in this repository
 ```bash
   python map_OG_to_EnzymesSubstrateClass_step1.py characterizedEnzymeMappings.tab qEXP_dALL_noSL.blp.top.og.sp.range qSL24_dALL.blp.top.og.sp.range   
 ```     
 Enjoy!
